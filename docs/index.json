[{"categories":["Network"],"content":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E).","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":" In this series of blog posts, I will walk through network automation with Nornir framework, but before we can dive into the good stuff, let’s build a lab that I can run automation on. ","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:0:0","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"1 Why using 3 different platform for the lab? It’s very common to use network equipment from more than one vendor (at least for ISPs). From my own limited experience, I’ve spent most time configuring and troubleshooting on Cisco IOS-XR and Huawei VRP routers for daily job. And invested quite a lot of time on Cisco IOS for my CCIE-RS exam. But didn’t have chance to work on Junos as much. Just like Chris mentioned in his blog post, I kind of hate to use Junos, guess it just didn’t click for me yet. Automating network equipment of multiple vendors is a painful process, especially when it comes to the ones that doesn’t have too much global presence, or the ones that are banned (*cough* Huawei *cough*). Most of modern automation tools have limited support for Huawei. Let’s see if I can have Nornir to work with Huawei VRP routers and get some automation action going. ","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:1:0","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"2 Lab details I prefer EVE-NG over GNS3, since I used to lab a lot on it when I was preparing for CCIE exam, and I will be using community version (version v2.0.3-112) for this lab. ","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:2:0","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"2.1 Import router images and get it running First thing first, we need to import router images to EVE-NG. It’s a bit of a hassle to install these images, but definitely not rocket science. Follow official guides for Juniper vMX \u0026 Cisco IOS-XRv and this post for Huawei VRP. Tip\r\rFor Junos: log in to VCP as root, type “cli” to enter Junos CLI\r\r Off to a good start, all 3 images are running, let's see the version info for each router: Juniper Junos: 20.4R3.8 root@vMX-R1\u003e show version Hostname: vMX-R1 Model: vmx Junos: 20.4R3.8 JUNOS OS Kernel 64-bit [20210618.f43645e_builder_stable_11-204ab] JUNOS OS libs [20210618.f43645e_builder_stable_11-204ab] ... Huawei VRP: 8.180 \u003cHuawei-R2\u003edisplay ver Huawei Versatile Routing Platform Software VRP (R) software, Version 8.180 (NE40E V800R011C00SPC607B607) Copyright (C) 2012-2018 Huawei Technologies Co., Ltd. HUAWEI NE40E uptime is 0 day, 14 hours, 3 minutes SVRP Platform Version 1.0 Cisco IOS-XR: 6.1.3 RP/0/0/CPU0:IOS-XR-R3#show version Thu May 5 08:09:51.127 UTC Cisco IOS XR Software, Version 6.1.3[Default] Copyright (c) 2017 by Cisco Systems, Inc. ROM: GRUB, Version 1.99(0), DEV RELEASE ... ","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:2:1","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"2.2 Build a lab in EVE-NG It’s time to build a simple lab around them to see if they work as intended. Interface IP addresses between Router X,Y is set to 192.168.XY.X/24 format. For connection between R1 and R2, it will be 192.168.12.1/24 for R1 and 192.168.12.2/24 for R2. And all 3 routers have lo0 interface with X.X.X.X/32 address assigned. Juniper vMX tip\r\rYou need to add both VCP and VFP, connect them together through em1 interface.\r\r EVE-NG Topology ","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:2:2","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"2.3 Change hostname \u0026 Configure interfaces Let’s configure interface IP addresses and do bunch of pings to make sure they are connected. \r\r\r\r$(function() {\r$( \"#tabs, #tabs1, #tabs2, #tabs3, #tabs4, #tabs5, #tabs6, #tabs7, #tabs8\" ).tabs();\r});\r\r Juniper \rHuawei \rCisco \r\r set system root-authentication plain-text-password set groups router system host-name vMX-R1 set apply-groups router set interfaces ge-0/0/0 unit 0 family inet address 192.168.12.1/24 set interfaces ge-0/0/1 unit 0 family inet address 192.168.13.1/24 set interfaces lo0 unit 0 family inet address 1.1.1.1/32 commit \r\r \u003cHUAWEI\u003esystem-view [~HUAWEI]sysname Huawei-R2 [~Huawei-R2]interface ether1/0/0 [~Huawei-R2-Ethernet1/0/0]ip address 192.168.12.2 255.255.255.0 [~Huawei-R2]interface ether1/0/1 [~Huawei-R2-Ethernet1/0/0]ip address 192.168.23.2 255.255.255.0 [~Huawei-R2]interface LoopBack0 [~Huawei-R2-LoopBack0]ip address 2.2.2.2 255.255.255.255 [~Huawei-R2-LoopBack0]commit \r\r RP/0/0/CPU0:ios#conf t RP/0/0/CPU0:ios(config)#hostname IOS-XR-R3 RP/0/0/CPU0:IOS-XR-R3(config)#int g0/0/0/0 RP/0/0/CPU0:IOS-XR-R3(config-if)#ipv4 address 192.168.13.3 255.255.255.0 RP/0/0/CPU0:IOS-XR-R3(config-if)#no shut RP/0/0/CPU0:IOS-XR-R3(config-if)#int g0/0/0/1 RP/0/0/CPU0:IOS-XR-R3(config-if)#ipv4 address 192.168.23.3 255.255.255.0 RP/0/0/CPU0:IOS-XR-R3(config-if)#no shut RP/0/0/CPU0:IOS-XR-R3(config-if)#int lo0 RP/0/0/CPU0:IOS-XR-R3(config-if)#ipv4 address 3.3.3.3 255.255.255.255 RP/0/0/CPU0:IOS-XR-R3(config-if)#commit \r\r\r .ui-tabs .ui-tabs-nav\r{\rbackground: #3b4252!important;\rpadding: 0px!important;\r}\r.ui-state-default{\rbackground: #2e3440!important;\rborder:0px!important;\r}\r.ui-state-default a {\rcolor:#b1b0b0!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-widget-content {\rbackground: #3b4252!important;\rpadding: 0px!important;\rborder:0px!important;\r}\r.ui-tabs-active{\rbackground: #282d37!important;\r}\r.ui-tabs-nav .ui-state-active a {\rcolor:#699ec1!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-tabs .ui-tabs-panel {\rbackground: #3b4252!important;\rborder:1px!important;\r}\r.ui-widget-header{\rborder:0px!important;\r}\r.single .content ul, .single .content ol{\rmargin-bottom:-10px;\r}\r\r","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:2:3","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"2.4 iBGP configuration (Full-mesh) Setting up BGP for Cisco and Huawei was very straight-forward. Junos is a little tricky, you have to add AS number under “routing-options” before you can configure iBGP commands. \r\r\r\r$(function() {\r$( \"#tabs, #tabs1, #tabs2, #tabs3, #tabs4, #tabs5, #tabs6, #tabs7, #tabs8\" ).tabs();\r});\r\r Juniper \rHuawei \rCisco \r\r root@vMX-R1\u003e show configuration routing-options { autonomous-system 123; } protocols { bgp { group ibgp-peers { type internal; neighbor 192.168.12.2; neighbor 192.168.13.3; } } } \r\r \u003cHuawei-R2\u003edis current-configuration configuration bgp bgp 123 peer 192.168.12.1 as-number 123 peer 192.168.23.3 as-number 123 # ipv4-family unicast undo synchronization peer 192.168.12.1 enable peer 192.168.23.3 enable \r\r RP/0/0/CPU0:IOS-XR-R3#sh run router bgp router bgp 123 address-family ipv4 unicast ! neighbor 192.168.13.1 remote-as 123 address-family ipv4 unicast ! ! neighbor 192.168.23.2 remote-as 123 address-family ipv4 unicast ! ! ! \r\r\r .ui-tabs .ui-tabs-nav\r{\rbackground: #3b4252!important;\rpadding: 0px!important;\r}\r.ui-state-default{\rbackground: #2e3440!important;\rborder:0px!important;\r}\r.ui-state-default a {\rcolor:#b1b0b0!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-widget-content {\rbackground: #3b4252!important;\rpadding: 0px!important;\rborder:0px!important;\r}\r.ui-tabs-active{\rbackground: #282d37!important;\r}\r.ui-tabs-nav .ui-state-active a {\rcolor:#699ec1!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-tabs .ui-tabs-panel {\rbackground: #3b4252!important;\rborder:1px!important;\r}\r.ui-widget-header{\rborder:0px!important;\r}\r.single .content ul, .single .content ol{\rmargin-bottom:-10px;\r}\r\r","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:2:4","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"2.5 Advertise loopback address to iBGP peers Advertising lo0 address is very simple for both Cisco and Huawei, one network command will do the job. However, with Junos you have to configure a policy and apply it to the BGP config. \r\r\r\r$(function() {\r$( \"#tabs, #tabs1, #tabs2, #tabs3, #tabs4, #tabs5, #tabs6, #tabs7, #tabs8\" ).tabs();\r});\r\r Juniper \rHuawei \rCisco \r\r set policy-options policy-statement advertise.lo0 term 1 from route-filter 1.1.1.1/32 exact set policy-options policy-statement advertise.lo0 term 1 then accept set protocols bgp group ibgp-peers export advertise.lo0 \r\r [~Huawei-R2]bgp 123 [~Huawei-R2-bgp]network 2.2.2.2 32 \r\r router bgp 123 address-family ipv4 unicast network 3.3.3.3 255.255.255.255 \r\r\r .ui-tabs .ui-tabs-nav\r{\rbackground: #3b4252!important;\rpadding: 0px!important;\r}\r.ui-state-default{\rbackground: #2e3440!important;\rborder:0px!important;\r}\r.ui-state-default a {\rcolor:#b1b0b0!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-widget-content {\rbackground: #3b4252!important;\rpadding: 0px!important;\rborder:0px!important;\r}\r.ui-tabs-active{\rbackground: #282d37!important;\r}\r.ui-tabs-nav .ui-state-active a {\rcolor:#699ec1!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-tabs .ui-tabs-panel {\rbackground: #3b4252!important;\rborder:1px!important;\r}\r.ui-widget-header{\rborder:0px!important;\r}\r.single .content ul, .single .content ol{\rmargin-bottom:-10px;\r}\r\rLet’s make sure BGP peering is correctly established and they are receving prefixes from each other. \r\r\r\r$(function() {\r$( \"#tabs, #tabs1, #tabs2, #tabs3, #tabs4, #tabs5, #tabs6, #tabs7, #tabs8\" ).tabs();\r});\r\r Juniper \rHuawei \rCisco \r\r \r \r \r\r .ui-tabs .ui-tabs-nav\r{\rbackground: #3b4252!important;\rpadding: 0px!important;\r}\r.ui-state-default{\rbackground: #2e3440!important;\rborder:0px!important;\r}\r.ui-state-default a {\rcolor:#b1b0b0!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-widget-content {\rbackground: #3b4252!important;\rpadding: 0px!important;\rborder:0px!important;\r}\r.ui-tabs-active{\rbackground: #282d37!important;\r}\r.ui-tabs-nav .ui-state-active a {\rcolor:#699ec1!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-tabs .ui-tabs-panel {\rbackground: #3b4252!important;\rborder:1px!important;\r}\r.ui-widget-header{\rborder:0px!important;\r}\r.single .content ul, .single .content ol{\rmargin-bottom:-10px;\r}\r\r","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:2:5","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"3 Complete configs Looks great so far, the following is full configuration for this lab. \r\r\r\r$(function() {\r$( \"#tabs, #tabs1, #tabs2, #tabs3, #tabs4, #tabs5, #tabs6, #tabs7, #tabs8\" ).tabs();\r});\r\r Juniper \rHuawei \rCisco \r\r root@vMX-R1\u003e show configuration groups { router { system { host-name vMX-R1; } } } apply-groups router; system { root-authentication { encrypted-password \"$6$PJBo9jFx$C2/jRVRHt/6wIJeRzJ4BJH6i.iDpoM5ZCkKkEMyUsnn9nPSDQcccK4mmvd8IGt.21Gp9x3bg3fZpmp6L/HxBI.\"; ## SECRET-DATA } } interfaces { ge-0/0/0 { unit 0 { family inet { address 192.168.12.1/24; } } } ge-0/0/1 { unit 0 { family inet { address 192.168.13.1/24; } } } lo0 { unit 0 { family inet { address 1.1.1.1/32; } } } } policy-options { policy-statement advertise.lo0 { term 1 { from { route-filter 1.1.1.1/32 exact; } then accept; } } } routing-options { autonomous-system 123; } protocols { router-advertisement { interface fxp0.0; } bgp { group ibgp-peers { type internal; export advertise.lo0; neighbor 192.168.12.2; neighbor 192.168.13.3; } } } \r\r \u003cHuawei-R2\u003edis current-configuration sysname Huawei-R2 # interface Ethernet1/0/0 undo shutdown ip address 192.168.12.2 255.255.255.0 # interface Ethernet1/0/1 undo shutdown ip address 192.168.23.2 255.255.255.0 # interface LoopBack0 ip address 2.2.2.2 255.255.255.255 # bgp 123 peer 192.168.12.1 as-number 123 peer 192.168.23.3 as-number 123 # ipv4-family unicast undo synchronization network 2.2.2.2 255.255.255.255 peer 192.168.12.1 enable peer 192.168.23.3 enable \r\r RP/0/0/CPU0:IOS-XR-R3#sh run hostname IOS-XR-R3 interface Loopback0 ipv4 address 3.3.3.3 255.255.255.255 ! interface GigabitEthernet0/0/0/0 ipv4 address 192.168.13.3 255.255.255.0 ! interface GigabitEthernet0/0/0/1 ipv4 address 192.168.23.3 255.255.255.0 ! router bgp 123 address-family ipv4 unicast network 3.3.3.3/32 ! neighbor 192.168.13.1 remote-as 123 address-family ipv4 unicast ! ! neighbor 192.168.23.2 remote-as 123 address-family ipv4 unicast ! ! ! \r\r\r .ui-tabs .ui-tabs-nav\r{\rbackground: #3b4252!important;\rpadding: 0px!important;\r}\r.ui-state-default{\rbackground: #2e3440!important;\rborder:0px!important;\r}\r.ui-state-default a {\rcolor:#b1b0b0!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-widget-content {\rbackground: #3b4252!important;\rpadding: 0px!important;\rborder:0px!important;\r}\r.ui-tabs-active{\rbackground: #282d37!important;\r}\r.ui-tabs-nav .ui-state-active a {\rcolor:#699ec1!important;\rfont-family:\"Arial\";\rfont-size:16px;\rfont-weight:bold;\r}\r.ui-tabs .ui-tabs-panel {\rbackground: #3b4252!important;\rborder:1px!important;\r}\r.ui-widget-header{\rborder:0px!important;\r}\r.single .content ul, .single .content ol{\rmargin-bottom:-10px;\r}\r\r","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:3:0","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"4 What’s next \u0026 TIL Success\r\rInitial part of the lab is finished.\r\r ","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:4:0","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"4.1 Next step I’ll add bits and pieces to make the lab suitable for automation, or completely overhaul the entire topology, just for the sake of messing around. 😂 ","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:4:1","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":["Network"],"content":"4.2 TIL TIL section is dedicated to the things that I’ve learned while writing blog posts, they can be either very trivial commands, or more complex concepts. TIL : Today I Learned\r\rTo show / compare uncommitted changes, simply run these commands: show | compare (Junos) display configuration candidate changes (Huawei VRP) show commit changes diff (Cisco IOS-XR) \r\r ","date":"2022-05-06","objectID":"/posts/eve-ng/eve-ng/:4:2","tags":["EVE-NG"],"title":"EVE-NG lab with Cisco IOS-XR, Juniper vMX and Huawei VRP(NE40E)","uri":"/posts/eve-ng/eve-ng/"},{"categories":null,"content":"About me Hi, my name is Kevin Jin, I’m a network engineer by day, dad by night, and this is my technical blog. Main purpose of this site is to record and share what I’ve learned. ","date":"2021-07-01","objectID":"/about/:0:0","tags":null,"title":"","uri":"/about/"}]